/**
 * Vanilla Javascript Sticky Table v1.0.2
 * https://zhitkovkostya.github.io/sticky-table
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).StickyTable=t()}(this,function(){"use strict";return class{constructor(e){this.originalTableElement=e,this.wrapperElement=this._wrapTable(),this.originalTableWrapperElement=this._wrapTableBody(),this.fixedTableWrapperElement=this._wrapTableHead(),this.fixedTableElement=this.fixedTableWrapperElement.querySelector("table"),this.scrollLeft=0,this._handleWindowScrollThrottled=this._throttle(this._handleWindowScroll.bind(this),20),this._handleWindowResizeThrottled=this._throttle(this._handleWindowResize.bind(this),20),this._handleHeadWrapperHorizontalScrollThrottled=this._throttle(this._handleHorizontalScroll.bind(this),20),this._handleBodyWrapperHorizontalScrollThrottled=this._throttle(this._handleHorizontalScroll.bind(this),20),this._syncColumnWidth(),this._syncHeadPosition(),this.fixedTableWrapperElement.addEventListener("scroll",this._handleHeadWrapperHorizontalScrollThrottled,!1),this.originalTableWrapperElement.addEventListener("scroll",this._handleBodyWrapperHorizontalScrollThrottled,!1),window.addEventListener("scroll",this._handleWindowScrollThrottled,!1),window.addEventListener("resize",this._handleWindowResizeThrottled)}_wrapTable(){const e=document.createElement("div");return e.className="js-table-wrapper",this.originalTableElement&&this.originalTableElement.parentNode&&(this.originalTableElement.parentNode.insertBefore(e,this.originalTableElement),e.append(this.originalTableElement)),e}_wrapTableHead(){const e=this.originalTableElement?this.originalTableElement.tHead:null;if(!e)throw new Error("<thead> is missing");var t=e.cloneNode(!0);const l=document.createElement("div");var i=document.createElement("table");return this._toggleHeadVisibility(e,!1),l.className="js-table-head-wrapper",l.dataset.isFixed="false",l.style.overflowX="auto",l.ariaHidden="true",l.appendChild(i).appendChild(t),this.wrapperElement&&this.originalTableWrapperElement&&this.wrapperElement.insertBefore(l,this.originalTableWrapperElement),l}_wrapTableBody(){const e=document.createElement("div");return e.className="js-table-body-wrapper",e.style.overflowX="auto",this.originalTableElement&&this.wrapperElement&&(this.wrapperElement.insertBefore(e,this.originalTableElement),e.appendChild(this.originalTableElement)),e}_syncColumnWidth(){var e,t=this.fixedTableElement,l=this.originalTableElement;let i,r;if(t&&l&&l.tHead&&t.tHead)for(const a of l.tHead.rows)for(const n of a.cells)i=t.tHead.rows[a.rowIndex].cells[n.cellIndex],e=window.getComputedStyle(n),r=Number(n.getBoundingClientRect().width.toFixed(2)),"content-box"===e.boxSizing&&(r-=parseFloat(e.paddingLeft),r-=parseFloat(e.paddingRight)),i.style.minWidth=r+"px",i.style.maxWidth=r+"px"}_syncHeadPosition(){if(this.fixedTableWrapperElement&&this.originalTableWrapperElement){let e="true"===this.fixedTableWrapperElement.dataset.isFixed;var{width:t,height:l}=this.fixedTableWrapperElement.getBoundingClientRect(),{top:i,width:r,height:a}=this.originalTableWrapperElement.getBoundingClientRect(),n=2*l,o=(e?0:l)<=i,s=a+i-l<=0;e&&(o||s)?(this.fixedTableWrapperElement.style.position="",this.fixedTableWrapperElement.style.top="",this.fixedTableWrapperElement.style.zIndex="",this.fixedTableWrapperElement.style.width="",this.originalTableWrapperElement.style.paddingTop="",this.fixedTableWrapperElement.dataset.isFixed="false",e=!1):e||o||s||(this.fixedTableWrapperElement.style.position="fixed",this.fixedTableWrapperElement.style.top="0",this.fixedTableWrapperElement.style.zIndex="2",this.fixedTableWrapperElement.style.width=r+"px",this.originalTableWrapperElement.style.paddingTop=l+"px",this.fixedTableWrapperElement.dataset.isFixed="true",e=!0),e&&a+i<n?this.fixedTableWrapperElement.style.transform="translate3d(0, "+(a+i-n)+"px, 0)":this.fixedTableWrapperElement.style.transform="",t!==r&&(this.fixedTableWrapperElement.style.width=r+"px")}}_syncHorizontalScroll(e,t){e=e.scrollLeft;this.scrollLeft!==e&&(this.scrollLeft=e,t.scrollLeft=e)}_toggleHeadVisibility(e,t=!1){if(!e)throw new Error("<thead> is missing");const l=Array.from(e.rows);var i=l.map(e=>Array.from(e.cells));const r=[].concat(...i);e.style.visibility=t?"":"collapse",r.forEach(e=>{e.style.height=t?"":"0",e.style.paddingTop=t?"":"0",e.style.paddingBottom=t?"":"0",e.style.lineHeight=t?"":"0"})}_handleHorizontalScroll(e){var t=e.target,e=t.nextSibling||t.previousSibling;this._syncHorizontalScroll(t,e)}_handleWindowScroll(){this._syncHeadPosition()}_handleWindowResize(){this._syncColumnWidth()}_throttle(t,l=100){let i=null;return(...e)=>{null===i&&(i=setTimeout(()=>{t.apply(this,e),i=null},l))}}destroy(){var e,t,l;for(window.removeEventListener("scroll",this._handleWindowScrollThrottled,!1),window.removeEventListener("resize",this._handleWindowResizeThrottled),null!==(l=this.fixedTableWrapperElement)&&void 0!==l&&l.removeEventListener("scroll",this._handleHeadWrapperHorizontalScrollThrottled,!1),null!==(l=this.originalTableWrapperElement)&&void 0!==l&&l.removeEventListener("scroll",this._handleBodyWrapperHorizontalScrollThrottled,!1);null!==(e=this.originalTableWrapperElement)&&void 0!==e&&e.firstChild;)null!==(e=this.wrapperElement)&&void 0!==e&&e.insertBefore(null===(e=this.originalTableWrapperElement)||void 0===e?void 0:e.firstChild,this.originalTableWrapperElement);for(;null!==(t=this.wrapperElement)&&void 0!==t&&t.firstChild;)null!==(t=this.wrapperElement.parentElement)&&void 0!==t&&t.insertBefore(null===(t=this.wrapperElement)||void 0===t?void 0:t.firstChild,this.wrapperElement);this.originalTableElement&&this.originalTableElement.tHead&&this._toggleHeadVisibility(this.originalTableElement.tHead,!0),null!==(l=this.fixedTableWrapperElement)&&void 0!==l&&l.remove(),null!==(l=this.originalTableWrapperElement)&&void 0!==l&&l.remove(),null!==(l=this.wrapperElement)&&void 0!==l&&l.remove(),delete this.originalTableElement,delete this.fixedTableWrapperElement,delete this.fixedTableElement,delete this.originalTableWrapperElement,delete this.wrapperElement,delete this.scrollLeft}}});
