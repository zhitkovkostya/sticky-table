/**
 * Vanilla Javascript Sticky Table v1.0.0
 * https://zhitkovkostya.github.io/sticky-table
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).StickyTable=t()}(this,function(){"use strict";function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.wrapperElement=null,this.headWrapperElement=null,this.bodyWrapperElement=null,this.scrollLeft=0,this._wrapTable(),this._wrapTableHead(),this._wrapTableBody(),this._syncColumnWidth(),this._syncHeadPosition(),window.addEventListener("scroll",this._handleWindowScrollThrottled.bind(this),!1),window.addEventListener("resize",this._handleWindowResizeThrottled.bind(this))}var e,r,n;return e=t,(r=[{key:"_wrapTable",value:function(){var e=document.createElement("div");e.className="js-table-wrapper",this.el.parentNode&&this.el.parentNode.insertBefore(e,this.el),e.append(this.el),this.wrapperElement=e}},{key:"_wrapTableHead",value:function(){var e=document.createElement("table"),t=this.el.tHead;if(!t)throw new Error("<thead> is missing");var r=Array.from(t.rows).map(function(e){return Array.from(e.cells)}),n=(n=[]).concat.apply(n,i(r)),r=t.cloneNode(!0);t.style.visibility="collapse",n.forEach(function(e){e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.lineHeight="0"}),e.classList.add("table"),this.headWrapperElement=document.createElement("div"),this.headWrapperElement.className="js-table-head-wrapper",this.headWrapperElement.dataset.isFixed="false",this.headWrapperElement.style.overflowX="auto",this.headWrapperElement.ariaHidden="true",this.headWrapperElement.appendChild(e).appendChild(r),this.wrapperElement&&this.wrapperElement.insertBefore(this.headWrapperElement,this.el),this.headWrapperElement.addEventListener("scroll",this._handleHeadWrapperHorizontalScrollThrottled.bind(this),!1)}},{key:"_wrapTableBody",value:function(){this.bodyWrapperElement=document.createElement("div"),this.bodyWrapperElement.className="js-table-body-wrapper",this.bodyWrapperElement.style.overflowX="auto",this.wrapperElement&&this.wrapperElement.insertBefore(this.bodyWrapperElement,this.el),this.bodyWrapperElement.appendChild(this.el),this.bodyWrapperElement.addEventListener("scroll",this._handleBodyWrapperHorizontalScrollThrottled.bind(this),!1)}},{key:"_syncColumnWidth",value:function(){var e=this.headWrapperElement&&this.headWrapperElement.querySelector("table"),t=this.bodyWrapperElement&&this.bodyWrapperElement.querySelector("table");if(e&&t&&t.tHead&&e.tHead){var r,n=h(t.tHead.rows);try{for(n.s();!(r=n.n()).done;){var l,i=r.value,a=h(i.cells);try{for(a.s();!(l=a.n()).done;){var o,s=l.value,d=s.offsetWidth;(o=e.tHead.rows[i.rowIndex].cells[s.cellIndex]).style.minWidth="".concat(d,"px"),o.style.maxWidth="".concat(d,"px")}}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}}}},{key:"_syncHeadPosition",value:function(){var e,t,r,n,l,i,a,o,s;this.headWrapperElement&&this.bodyWrapperElement&&(e="true"===this.headWrapperElement.dataset.isFixed,t=(i=this.headWrapperElement.getBoundingClientRect()).width,r=i.height,n=(s=this.bodyWrapperElement.getBoundingClientRect()).top,l=s.width,a=2*r,o=(e?0:r)<=n,s=(i=s.height)+n-r<=0,e&&(o||s)?(this.headWrapperElement.style.position="",this.headWrapperElement.style.top="",this.headWrapperElement.style.zIndex="",this.headWrapperElement.style.width="",this.bodyWrapperElement.style.paddingTop="",e=!(this.headWrapperElement.dataset.isFixed="false")):e||o||s||(this.headWrapperElement.style.position="fixed",this.headWrapperElement.style.top="0",this.headWrapperElement.style.zIndex="2",this.headWrapperElement.style.width=l+"px",this.bodyWrapperElement.style.paddingTop=r+"px",this.headWrapperElement.dataset.isFixed="true",e=!0),this.headWrapperElement.style.transform=e&&i+n<a?"translate3d(0, "+(i+n-a)+"px, 0)":"",t!==l&&(this.headWrapperElement.style.width=l+"px"))}},{key:"_syncHorizontalScroll",value:function(e,t){e=e.scrollLeft;this.scrollLeft!==e&&(this.scrollLeft=e,t.scrollLeft=e)}},{key:"_handleHorizontalScroll",value:function(e){var t=e.target,e=t.nextSibling||t.previousSibling;t&&this._syncHorizontalScroll(t,e)}},{key:"_handleWindowScroll",value:function(){this._syncHeadPosition()}},{key:"_handleWindowScrollThrottled",value:function(){return this._throttle(this._handleWindowScroll.bind(this),20)}},{key:"_handleWindowResize",value:function(){this._syncHeadPosition()}},{key:"_handleWindowResizeThrottled",value:function(){return this._throttle(this._handleWindowResize.bind(this),20)}},{key:"_handleHeadWrapperHorizontalScrollThrottled",value:function(){return this._throttle(this._handleHorizontalScroll.bind(this),10)}},{key:"_handleBodyWrapperHorizontalScrollThrottled",value:function(){return this._throttle(this._handleHorizontalScroll.bind(this),10)}},{key:"_throttle",value:function(n){var l=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,a=null;return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];null===a&&(a=setTimeout(function(){n.apply(l,t),a=null},i))}}},{key:"destroy",value:function(){window.removeEventListener("scroll",this._handleWindowScrollThrottled,!1),window.removeEventListener("resize",this._handleWindowResizeThrottled),this.headWrapperElement&&this.headWrapperElement.removeEventListener("scroll",this._handleBodyWrapperHorizontalScrollThrottled,!1),this.bodyWrapperElement&&this.bodyWrapperElement.removeEventListener("scroll",this._handleBodyWrapperHorizontalScrollThrottled,!1)}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()});
